<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tu Ti√™n V·∫≠t L√≠ 11 - S√≥ng D·ª´ng</title>
  <style>
    :root{
      --bg1:#0f1025; --bg2:#1b1e3b; --accent:#facc15; --primary:#60a5fa; --ok:#4ade80; --bad:#ef4444;
      --panel:#ffffff18; --panel2:#ffffff26;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, "Segoe UI", sans-serif;
      color: #fff;
      background: radial-gradient(1200px 800px at 50% -20%, #3b1d5a 0%, #151635 40%, #0f1025 100%),
                  linear-gradient(180deg, var(--bg1), var(--bg2));
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      padding: 12px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      backdrop-filter: blur(6px);
      background: linear-gradient(90deg, #ffffff10, #00000000);
      border-bottom: 1px solid #ffffff20;
    }
    header .title { font-weight: 700; color: var(--accent); }
    header .info { font-size: 14px; opacity: .85; }
    .container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      padding: 12px;
    }
    .panel {
      background: var(--panel);
      border: 1px solid #ffffff25;
      border-radius: 14px;
      padding: 14px;
      min-height: 280px;
    }
    .left {
      background: linear-gradient(180deg, #ffffff10, #ffffff08);
      position: relative;
      overflow: hidden;
    }
    .aura {
      position: absolute; inset: -30%;
      background:
        radial-gradient(450px 260px at 15% 20%, #5b21b616 0%, transparent 60%),
        radial-gradient(520px 280px at 85% 40%, #22c55e22 0%, transparent 65%),
        radial-gradient(400px 240px at 50% 85%, #60a5fa18 0%, transparent 60%);
      filter: blur(12px);
      pointer-events: none;
    }
    h1, h2 { color: var(--accent); margin: 6px 0 10px; }
    .intro { line-height: 1.6; font-size: 15px; }
    .realm-list { display: grid; grid-template-columns: repeat(2,1fr); gap: 8px; margin-top: 10px; }
    .realm {
      background: #0b0c1f80; border: 1px solid #ffffff20; border-radius: 10px; padding: 10px; font-size: 14px;
    }
    .right { background: var(--panel2); }
    label { font-size: 14px; opacity: .9; }
    input, select, button {
      width: 100%; padding: 10px 12px; margin-top: 6px; border: 1px solid #ffffff30; border-radius: 10px;
      background: #0b0c1f; color: #fff; font-size: 16px;
    }
    button.primary { background: linear-gradient(90deg, #22c55e, #a3e635); border: none; color: #04120b; font-weight: 700; }
    .control-grid { display: grid; gap: 10px; margin-top: 8px; }
    .chips { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px; }
    .chip {
      padding: 6px 10px; border-radius: 999px; border: 1px solid #ffffff25; background: #0b0c1f80; font-size: 13px;
    }
    .hud {
      margin-top: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 14px;
    }
    .pill { background: #0b0c1f90; border: 1px solid #ffffff25; border-radius: 999px; padding: 8px 10px; text-align: center; }
    .quiz-box {
      margin-top: 12px; background: #0b0c1fb0; border: 1px solid #ffffff25; border-radius: 12px; padding: 12px;
      display: none;
    }
    .question { font-size: 18px; line-height: 1.5; }
    .answers { display: grid; gap: 8px; margin-top: 10px; }
    .answers button { background: #1d4ed8; border: none; }
    .answers button:hover { filter: brightness(1.08); }
    .status { margin-top: 8px; font-size: 14px; opacity: .9; }
    .progress {
      height: 8px; background: #0b0c1f; border-radius: 999px; border: 1px solid #ffffff22; margin-top: 8px; overflow: hidden;
    }
    .bar { height: 100%; width: 0%; background: linear-gradient(90deg, #22c55e, #3b82f6); transition: width .2s linear; }
    .toast {
      position: fixed; bottom: 14px; left: 14px; right: 14px; background: #0b0c1fee; border: 1px solid #22c55e55;
      border-radius: 12px; padding: 10px 12px; display: none; font-size: 15px;
    }
    .badge { display: inline-block; padding: 4px 8px; border-radius: 999px; background: #22c55e22; border: 1px solid #22c55e66; color: #a7f3d0; font-size: 12px; margin-left: 6px; }
    .fail { border-color: #ef444477; background: #150c0cee; color: #fecaca; }
    .rank { margin-top: 12px; display: none; }
    .rank .item { display:flex; align-items:center; justify-content:space-between; padding:8px 10px; border:1px solid #ffffff20; border-radius:10px; background:#0b0c1f80; margin-top:6px; }
    @media (max-width: 860px) {
      .container { grid-template-columns: 1fr; }
      header .info { display: none; }
    }
  </style>
</head>
<body>
  <header>
    <div class="title">Tu Ti√™n V·∫≠t L√≠ 11 ‚Äî S√≥ng d·ª´ng</div>
    <div class="info">M·ªói c√¢u: 10 gi√¢y ‚Ä¢ ƒê√∫ng +100 linh kh√≠ ‚Ä¢ Sai quay ƒë·∫ßu c·∫£nh gi·ªõi</div>
  </header>

  <div class="container">
    <div class="panel left">
      <div class="aura"></div>
      <h1>H√†nh tr√¨nh tu ti√™n</h1>
      <p class="intro">
        B·∫°n l√† tu sƒ© b∆∞·ªõc v√†o ƒë·∫°o, tu luy·ªán qua c√°c c·∫£nh gi·ªõi b·∫±ng tri th·ª©c S√≥ng d·ª´ng (V·∫≠t L√≠ 11).
        M·ªói c·∫£nh gi·ªõi c√≥ s·ªë c√¢u tƒÉng d·∫ßn, sai l√† ph·∫£i tu l·∫°i t·ª´ ƒë·∫ßu c·∫£nh gi·ªõi. T√≠ch l≈©y linh kh√≠ ƒë·ªÉ thƒÉng c·∫•p!
      </p>
      <div class="realm-list">
        <div class="realm">Luy·ªán kh√≠ ‚Äî 2 c√¢u</div>
        <div class="realm">Tr√∫c c∆° ‚Äî 4 c√¢u</div>
        <div class="realm">K·∫øt ƒêan ‚Äî 6 c√¢u</div>
        <div class="realm">K·∫øt ƒêan h·∫≠u k·ª≥ ‚Äî 10 c√¢u</div>
        <div class="realm">Nguy√™n Anh ‚Äî 15 c√¢u</div>
        <div class="realm">H√≥a Th·∫ßn ‚Äî 20 c√¢u</div>
      </div>
      <p class="intro" style="margin-top:10px">
        M·∫πo: ƒê·ªçc k·ªπ kh√°i ni·ªám n√∫t, b·ª•ng, ƒëi·ªÅu ki·ªán t·∫°o s√≥ng d·ª´ng v√† ph√¢n bi·ªát v·ªõi s√≥ng ch·∫°y. ƒê·ª´ng ƒë·ªÉ ph√°p tr·∫≠n v·ª°!
      </p>
      <div class="rank" id="rankBox">
        <h2>B·∫£ng vinh danh</h2>
        <div id="rankList"></div>
      </div>
    </div>

    <div class="panel right">
      <h2>B·∫£ng ƒëi·ªÅu khi·ªÉn</h2>
      <div class="control-grid">
        <div>
          <label for="name">Ghi danh</label>
          <input id="name" placeholder="Nh·∫≠p ph√°p danh tu sƒ©..."/>
        </div>
        <div>
          <label for="mode">Ch·∫ø ƒë·ªô tu luy·ªán</label>
          <select id="mode">
            <option>ƒêan s∆∞</option>
            <option>Ki·∫øm tu</option>
            <option>Ph√°p tu</option>
          </select>
          <div class="chips">
            <div class="chip">ƒêan s∆∞: +hi·ªáu ·ª©ng b√∫i linh kh√≠</div>
            <div class="chip">Ki·∫øm tu: +t·ªëc ƒë·ªô √°nh s√°ng</div>
            <div class="chip">Ph√°p tu: +√°nh ph√°p tr·∫≠n</div>
          </div>
        </div>
        <button class="primary" id="startBtn">B·∫Øt ƒë·∫ßu tu luy·ªán</button>
      </div>

      <div class="hud">
        <div class="pill" id="realmPill">C·∫£nh gi·ªõi: ‚Äî</div>
        <div class="pill" id="qiPill">Linh kh√≠: 0</div>
      </div>

      <div class="quiz-box" id="quizBox">
        <div class="question" id="questionText"></div>
        <div class="answers" id="answers"></div>
        <div class="progress"><div class="bar" id="timeBar"></div></div>
        <div class="status" id="statusText"></div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // Thi·∫øt l·∫≠p c·∫£nh gi·ªõi v√† s·ªë c√¢u
    const stages = [
      { name: "Luy·ªán kh√≠", count: 2 },
      { name: "Tr√∫c c∆°", count: 4 },
      { name: "K·∫øt ƒêan", count: 6 },
      { name: "K·∫øt ƒêan h·∫≠u k·ª≥", count: 10 },
      { name: "Nguy√™n Anh", count: 15 },
      { name: "H√≥a Th·∫ßn", count: 20 }
    ];

    // Ng√¢n h√†ng 60 c√¢u l√Ω thuy·∫øt S√≥ng d·ª´ng (ƒë·ªß cho 57 c√¢u y√™u c·∫ßu)
    // Ch·ªß ƒë·ªÅ: ƒë·ªãnh nghƒ©a, n√∫t/b·ª•ng, kho·∫£ng c√°ch, ƒëi·ªÅu ki·ªán, t·∫ßn s·ªë/h·ªç mode, v√≠ d·ª•, so s√°nh v·ªõi s√≥ng ch·∫°y, nƒÉng l∆∞·ª£ng
    const bank = [
      {q:"S√≥ng d·ª´ng l√† g√¨?",a:["S√≥ng giao thoa gi·ªØa s√≥ng t·ªõi v√† ph·∫£n x·∫°","S√≥ng lan truy·ªÅn m·ªôt chi·ªÅu","S√≥ng c∆° b·∫•t k·ª≥","S√≥ng do ngu·ªìn di chuy·ªÉn"],c:0},
      {q:"N√∫t s√≥ng l√† ƒëi·ªÉm n√†o tr√™n m√¥i tr∆∞·ªùng dao ƒë·ªông?",a:["Dao ƒë·ªông c·ª±c ƒë·∫°i","Dao ƒë·ªông c·ª±c ti·ªÉu","Kh√¥ng dao ƒë·ªông","Dao ƒë·ªông ng·∫´u nhi√™n"],c:2},
      {q:"B·ª•ng s√≥ng l√† ƒëi·ªÉm n√†o?",a:["Bi√™n ƒë·ªô c·ª±c ƒë·∫°i","Bi√™n ƒë·ªô b·∫±ng 0","ƒêi·ªÉm ph·∫£n x·∫°","ƒêi·ªÉm truy·ªÅn ngu·ªìn"],c:0},
      {q:"Kho·∫£ng c√°ch gi·ªØa hai n√∫t li√™n ti·∫øp l√† bao nhi√™u?",a:["Œª","Œª/2","2Œª","Œª/4"],c:1},
      {q:"Kho·∫£ng c√°ch gi·ªØa hai b·ª•ng li√™n ti·∫øp l√† bao nhi√™u?",a:["Œª/2","Œª","2Œª","Œª/4"],c:0},
      {q:"Kho·∫£ng c√°ch gi·ªØa n√∫t v√† b·ª•ng k·ªÅ nhau l√† bao nhi√™u?",a:["Œª/4","Œª/2","Œª","2Œª"],c:0},
      {q:"S√≥ng d·ª´ng h√¨nh th√†nh ch·ªß y·∫øu do hi·ªán t∆∞·ª£ng g√¨?",a:["Nhi·ªÖu x·∫°","Giao thoa","Kh√∫c x·∫°","C·ªông h∆∞·ªüng √¢m"],c:1},
      {q:"Trong s√≥ng d·ª´ng, nƒÉng l∆∞·ª£ng c√≥ lan truy·ªÅn theo ph∆∞∆°ng truy·ªÅn s√≥ng kh√¥ng?",a:["C√≥","Kh√¥ng","T√πy bi√™n ƒë·ªô","T√πy t·∫ßn s·ªë"],c:1},
      {q:"ƒêi·ªÅu ki·ªán bi√™n ƒë·ªÉ c√≥ n√∫t t·∫°i ƒë·∫ßu c·ªë ƒë·ªãnh l√† g√¨?",a:["Bi√™n ƒë·ªô c·ª±c ƒë·∫°i","Bi√™n ƒë·ªô b·∫±ng 0","Pha dao ƒë·ªông l·ªách œÄ/2","Kh√¥ng c√≥ ƒëi·ªÅu ki·ªán"],c:1},
      {q:"V√≠ d·ª• th·ª±c t·∫ø ƒëi·ªÉn h√¨nh c·ªßa s√≥ng d·ª´ng l√† g√¨?",a:["D√¢y ƒë√†n b·ªãt hai ƒë·∫ßu","S√≥ng bi·ªÉn kh∆°i","S√≥ng ƒë·ªãa ch·∫•n P","S√≥ng √°nh s√°ng tr·∫Øng"],c:0},
      {q:"Trong mode c∆° b·∫£n (n=1) c·ªßa d√¢y cƒÉng hai ƒë·∫ßu c·ªë ƒë·ªãnh c√≥ bao nhi√™u b·ª•ng?",a:["1","2","3","Kh√¥ng b·ª•ng"],c:1},
      {q:"Trong mode c∆° b·∫£n c·ªßa d√¢y cƒÉng hai ƒë·∫ßu c·ªë ƒë·ªãnh c√≥ bao nhi√™u n√∫t (t√≠nh c·∫£ hai ƒë·∫ßu)?",a:["1","2","3","0"],c:2},
      {q:"Khi tƒÉng t·∫ßn s·ªë, s·ªë b·ª•ng tr√™n d√¢y hai ƒë·∫ßu c·ªë ƒë·ªãnh",a:["Gi·∫£m","TƒÉng","Kh√¥ng ƒë·ªïi","Bi·∫øn thi√™n ng·∫´u nhi√™n"],c:1},
      {q:"H·ªç mode ri√™ng c·ªßa d√¢y hai ƒë·∫ßu c·ªë ƒë·ªãnh c√≥ t·∫ßn s·ªë fn th·ªèa m√£n",a:["fn = n¬∑f1","fn = f1/n","fn = ‚àön¬∑f1","fn = n¬≤¬∑f1"],c:0},
      {q:"Trong ·ªëng s√°o h·ªü-h·ªü, kho·∫£ng c√°ch gi·ªØa b·ª•ng li√™n ti·∫øp l√†",a:["Œª/2","Œª","Œª/4","3Œª/4"],c:0},
      {q:"Trong ·ªëng s√°o h·ªü-h·ªü, t·∫°i hai ƒë·∫ßu l√†",a:["N√∫t","B·ª•ng","M·ªôt n√∫t m·ªôt b·ª•ng","Kh√¥ng x√°c ƒë·ªãnh"],c:1},
      {q:"Trong ·ªëng s√°o h·ªü-k√≠n (m·ªôt ƒë·∫ßu b·ªãt), t·∫°i ƒë·∫ßu k√≠n l√†",a:["B·ª•ng","N√∫t","Kh√¥ng dao ƒë·ªông","Dao ƒë·ªông c·ª±c ƒë·∫°i"],c:1},
      {q:"·ªêng h·ªü-k√≠n c√≥ c√°c mode th·ªèa ƒëi·ªÅu ki·ªán",a:["n = 1,2,3,...","n l·∫ª: 1,3,5,...","n ch·∫µn: 2,4,6,...","Ch·ªâ n=2"],c:1},
      {q:"·ªû n√∫t s√≥ng, bi√™n ƒë·ªô dao ƒë·ªông h·∫°t m√¥i tr∆∞·ªùng",a:["C·ª±c ƒë·∫°i","C·ª±c ti·ªÉu","B·∫±ng 0","Kh√¥ng x√°c ƒë·ªãnh"],c:2},
      {q:"·ªû b·ª•ng s√≥ng, bi√™n ƒë·ªô dao ƒë·ªông h·∫°t m√¥i tr∆∞·ªùng",a:["B·∫±ng 0","C·ª±c ƒë·∫°i","C·ª±c ti·ªÉu","Kh√¥ng x√°c ƒë·ªãnh"],c:1},
      {q:"S√≥ng d·ª´ng kh√°c s√≥ng ch·∫°y ·ªü ƒëi·ªÉm n√†o?",a:["C√≥ n√∫t v√† b·ª•ng c·ªë ƒë·ªãnh","Lan truy·ªÅn nƒÉng l∆∞·ª£ng m·∫°nh","Kh√¥ng c√≥ giao thoa","Kh√¥ng c·∫ßn ph·∫£n x·∫°"],c:0},
      {q:"B∆∞·ªõc s√≥ng Œª li√™n h·ªá v·ªõi kho·∫£ng c√°ch n√∫t-b·ª•ng k·ªÅ nhau nh∆∞ th·∫ø n√†o?",a:["Œª = 4¬∑d_n√∫t-b·ª•ng","Œª = 2¬∑d_n√∫t-b·ª•ng","Œª = d_n√∫t-b·ª•ng","Œª = 8¬∑d_n√∫t-b·ª•ng"],c:0},
      {q:"Trong d√¢y cƒÉng, s√≥ng d·ª´ng t·∫°o b·ªüi hai s√≥ng c√≥",a:["C√πng bi√™n ƒë·ªô, c√πng t·∫ßn s·ªë, ng∆∞·ª£c chi·ªÅu","Kh√°c t·∫ßn s·ªë","Kh√°c bi√™n ƒë·ªô","C√πng chi·ªÅu"],c:0},
      {q:"·ªû n√∫t s√≥ng, pha dao ƒë·ªông c·ªßa c√°c ƒëi·ªÉm l√¢n c·∫≠n",a:["Nh∆∞ nhau","Kh√°c nhau 180¬∞","Ng·∫´u nhi√™n","Kh√¥ng x√°c ƒë·ªãnh"],c:1},
      {q:"ƒê·ªÉ c√≥ s√≥ng d·ª´ng r√µ tr√™n d√¢y, ch·ªçn t·∫ßn s·ªë ngu·ªìn",a:["B·∫•t k·ª≥","G·∫ßn mode ri√™ng","R·∫•t l·ªõn","R·∫•t nh·ªè"],c:1},
      {q:"Khi ngu·ªìn ƒë√∫ng t·∫ßn s·ªë c·ªông h∆∞·ªüng, bi√™n ƒë·ªô t·∫°i b·ª•ng",a:["TƒÉng l·ªõn","Gi·∫£m nh·ªè","B·∫±ng 0","Kh√¥ng ƒë·ªïi"],c:0},
      {q:"Trong s√≥ng d·ª´ng, c√°c b·ª•ng c√°ch nhau",a:["Œª","Œª/2","2Œª","Œª/4"],c:1},
      {q:"Trong s√≥ng ch·∫°y, m·ªçi ƒëi·ªÉm tr√™n d√¢y",a:["Dao ƒë·ªông v·ªõi c√πng bi√™n ƒë·ªô","Dao ƒë·ªông v·ªõi bi√™n ƒë·ªô kh√°c nhau theo v·ªã tr√≠","Kh√¥ng dao ƒë·ªông","Dao ƒë·ªông m·ªôt l·∫ßn r·ªìi d·ª´ng"],c:1},
      {q:"NƒÉng l∆∞·ª£ng trong s√≥ng d·ª´ng ph√¢n b·ªë",a:["ƒê·ªÅu to√†n m√¥i tr∆∞·ªùng","T·∫≠p trung quanh b·ª•ng","Ch·ªâ ·ªü n√∫t","Kh√¥ng t·ªìn t·∫°i"],c:1},
      {q:"Trong d√¢y hai ƒë·∫ßu c·ªë ƒë·ªãnh, mode n=3 c√≥ bao nhi√™u b·ª•ng?",a:["2","3","4","1"],c:1},
      {q:"Trong d√¢y hai ƒë·∫ßu c·ªë ƒë·ªãnh, mode n=3 c√≥ bao nhi√™u n√∫t (k·ªÉ c·∫£ ƒë·∫ßu)?",a:["3","4","5","2"],c:2},
      {q:"·ªêng h·ªü-k√≠n mode c∆° b·∫£n c√≥ d·∫°ng",a:["B·ª•ng ·ªü hai ƒë·∫ßu","N√∫t ·ªü hai ƒë·∫ßu","B·ª•ng ·ªü h·ªü, n√∫t ·ªü k√≠n","N√∫t ·ªü h·ªü, b·ª•ng ·ªü k√≠n"],c:2},
      {q:"S√≥ng d·ª´ng xu·∫•t hi·ªán m·∫°nh khi c√≥",a:["Ph·∫£n x·∫° t·ªët t·∫°i bi√™n","T·∫Øt ph·∫£n x·∫°","Kh√∫c x·∫° m·∫°nh","Nhi·ªÖu x·∫°"],c:0},
      {q:"Trong th√≠ nghi·ªám Melde (d√¢y rung), s√≥ng d·ª´ng xu·∫•t hi·ªán khi",a:["Ch·ªçn t·∫ßn s·ªë th√≠ch h·ª£p","Gi·∫£m l·ª±c cƒÉng","TƒÉng ma s√°t","B·ªè ngu·ªìn"],c:0},
      {q:"Pha dao ƒë·ªông gi·ªØa hai b·ª•ng k·ªÅ nhau",a:["Gi·ªëng nhau","Kh√°c nhau œÄ","Kh√°c nhau œÄ/2","Ng·∫´u nhi√™n"],c:1},
      {q:"Pha dao ƒë·ªông gi·ªØa hai n√∫t k·ªÅ nhau",a:["Gi·ªëng nhau","Kh√°c nhau œÄ","Kh√°c nhau œÄ/2","Ng·∫´u nhi√™n"],c:1},
      {q:"Trong s√≥ng d·ª´ng, bi√™n ƒë·ªô ph·ª• thu·ªôc",a:["V·ªã tr√≠","Th·ªùi gian","Ngu·ªìn nhi·ªát","Kh√¥ng ph·ª• thu·ªôc"],c:0},
      {q:"Trong s√≥ng ch·∫°y, bi√™n ƒë·ªô ph·ª• thu·ªôc",a:["V·ªã tr√≠ theo d·∫°ng n√∫t-b·ª•ng","Ch·ªß y·∫øu kh√¥ng ƒë·ªïi theo v·ªã tr√≠ (trong m√¥i tr∆∞·ªùng ƒë·ªìng nh·∫•t)","Ch·ªâ th·ªùi gian","Kh√¥ng ph·ª• thu·ªôc g√¨"],c:1},
      {q:"ƒêi·ªÅu ki·ªán ƒë·ªÉ t·∫°o n√∫t t·∫°i ƒë·∫ßu t·ª± do (h·ªü) c·ªßa ·ªëng kh√≠ l√†",a:["Bi√™n ƒë·ªô b·∫±ng 0","Bi√™n ƒë·ªô c·ª±c ƒë·∫°i","Pha l·ªách œÄ","Kh√¥ng ƒëi·ªÅu ki·ªán"],c:1},
      {q:"Trong d√¢y, t·ªëc ƒë·ªô truy·ªÅn v ph·ª• thu·ªôc",a:["L·ª±c cƒÉng v√† kh·ªëi l∆∞·ª£ng ri√™ng tuy·∫øn t√≠nh","Chi·ªÅu d√†i d√¢y","Pha ngu·ªìn","Kh√¥ng ph·ª• thu·ªôc"],c:0},
      {q:"T·∫ßn s·ªë ri√™ng f1 c·ªßa d√¢y 2 ƒë·∫ßu c·ªë ƒë·ªãnh tƒÉng khi",a:["TƒÉng chi·ªÅu d√†i","Gi·∫£m l·ª±c cƒÉng","TƒÉng l·ª±c cƒÉng ho·∫∑c gi·∫£m kh·ªëi l∆∞·ª£ng ri√™ng","TƒÉng ma s√°t"],c:2},
      {q:"S√≥ng d·ª´ng c√≥ th·ªÉ th·∫•y trong nh·∫°c c·ª• n√†o?",a:["Piano, guitar, s√°o","K√®n harmonica","Tr·ªëng ch·ªâ c√≥ xung","Kh√¥ng nh·∫°c c·ª• n√†o"],c:0},
      {q:"·ªû n√∫t, v·∫≠n t·ªëc t·ª©c th·ªùi c·ªßa ph·∫ßn t·ª≠ m√¥i tr∆∞·ªùng",a:["Lu√¥n b·∫±ng 0","C·ª±c ƒë·∫°i","C·ª±c ti·ªÉu","Kh√¥ng x√°c ƒë·ªãnh"],c:0},
      {q:"·ªû b·ª•ng, v·∫≠n t·ªëc t·ª©c th·ªùi c·ªßa ph·∫ßn t·ª≠ m√¥i tr∆∞·ªùng",a:["Lu√¥n b·∫±ng 0","C·ª±c ƒë·∫°i khi qua v·ªã tr√≠ c√¢n b·∫±ng","C·ª±c ti·ªÉu","Kh√¥ng x√°c ƒë·ªãnh"],c:1},
      {q:"M√¥ t·∫£ h√¨nh d·∫°ng mode n=2 c·ªßa d√¢y 2 ƒë·∫ßu c·ªë ƒë·ªãnh",a:["1 b·ª•ng gi·ªØa","2 b·ª•ng, 3 n√∫t (t√≠nh c·∫£ hai ƒë·∫ßu)","3 b·ª•ng, 4 n√∫t","Kh√¥ng b·ª•ng"],c:1},
      {q:"Trong ·ªëng h·ªü-h·ªü, mode n=2 c√≥",a:["B·ª•ng ·ªü hai ƒë·∫ßu v√† 1 b·ª•ng gi·ªØa","N√∫t ·ªü hai ƒë·∫ßu","Ch·ªâ 1 b·ª•ng","Kh√¥ng b·ª•ng"],c:0},
      {q:"S√≥ng d·ª´ng xu·∫•t hi·ªán khi hai s√≥ng ch·ªìng ch·∫•t c√≥",a:["Kh√°c t·∫ßn s·ªë ch√∫t √≠t","C√πng t·∫ßn s·ªë v√† bi√™n ƒë·ªô g·∫ßn b·∫±ng","C√πng pha ho√†n to√†n","Kh√°c ph∆∞∆°ng truy·ªÅn"],c:1},
      {q:"Bi·ªÉu hi·ªán quan s√°t ƒë·ªÉ ph√¢n bi·ªát s√≥ng d·ª´ng tr√™n d√¢y",a:["C√°c ƒëi·ªÉm c√πng dao ƒë·ªông","C√≥ ƒëi·ªÉm ƒë·ª©ng y√™n (n√∫t)","Bi√™n ƒë·ªô tƒÉng d·∫ßn theo th·ªùi gian","D√¢y r·ªëi"],c:1},
      {q:"Trong s√≥ng ch·∫°y, nƒÉng l∆∞·ª£ng",a:["Kh√¥ng truy·ªÅn","Truy·ªÅn theo h∆∞·ªõng s√≥ng","Ch·ªâ t·∫°i ngu·ªìn","Ch·ªâ t·∫°i bi√™n"],c:1},
      {q:"S√≥ng d·ª´ng tr√™n d√¢y t·∫°o th√†nh c√°c ƒëo·∫°n",a:["ƒêo·∫°n y√™n v√† ƒëo·∫°n m·∫°nh xen k·∫Ω","ƒêo·∫°n ƒë·ªÅu nhau","ƒêo·∫°n ch·ªâ m·∫°nh","ƒêo·∫°n ch·ªâ y√™n"],c:0},
      {q:"ƒêi·ªÅu ki·ªán h√¨nh th√†nh mode n tr√™n d√¢y 2 ƒë·∫ßu c·ªë ƒë·ªãnh: chi·ªÅu d√†i L th·ªèa",a:["L = n¬∑Œª","L = n¬∑Œª/2","L = Œª/(2n)","L = 2n¬∑Œª"],c:1},
      {q:"Trong ·ªëng h·ªü-k√≠n, chi·ªÅu d√†i L th·ªèa mode n l·∫ª",a:["L = n¬∑Œª/2","L = n¬∑Œª","L = (2n-1)¬∑Œª/4","L = Œª/(2n)"],c:2},
      {q:"N·∫øu thay ƒë·ªïi ƒëi·ªÅu ki·ªán bi√™n, h·ªç mode",a:["Kh√¥ng ƒë·ªïi","Thay ƒë·ªïi d·∫°ng v√† t·∫ßn s·ªë ri√™ng","Ch·ªâ ƒë·ªïi t√™n","Bi·∫øn m·∫•t"],c:1},
      {q:"S√≥ng d·ª´ng c√≥ d·∫°ng ph∆∞∆°ng tr√¨nh t·ªïng qu√°t (√Ω ni·ªám)",a:["H·ª£p c·ªßa hai s√≥ng ng∆∞·ª£c chi·ªÅu","M·ªôt s√≥ng ƒë·ªôc l·∫≠p","M·ªôt xung","M·ªôt dao ƒë·ªông t·∫Øt d·∫ßn"],c:0},
      {q:"·ªû b·ª•ng, l·ª±c ƒë√†n h·ªìi t·ª©c th·ªùi tr√™n d√¢y",a:["Lu√¥n b·∫±ng 0","C·ª±c ƒë·∫°i khi l·ªách kh·ªèi c√¢n b·∫±ng","Kh√¥ng x√°c ƒë·ªãnh","Lu√¥n d∆∞∆°ng"],c:1},
      {q:"·ªû n√∫t, l·ª±c ƒë√†n h·ªìi t·ª©c th·ªùi tr√™n d√¢y",a:["Lu√¥n b·∫±ng 0 do kh√¥ng l·ªách v·ªã tr√≠","C·ª±c ƒë·∫°i","Kh√¥ng x√°c ƒë·ªãnh","Lu√¥n √¢m"],c:0},
      {q:"Quan h·ªá v·ªã tr√≠ n√∫t v·ªõi bi√™n c·ªë ƒë·ªãnh c·ªßa d√¢y",a:["Tr√πng bi√™n c·ªë ƒë·ªãnh","C√°ch bi√™n m·ªôt Œª/2","Tr√πng b·ª•ng","Kh√¥ng x√°c ƒë·ªãnh"],c:0},
      {q:"Trong s√≥ng d·ª´ng √¢m trong ·ªëng h·ªü-h·ªü, √°p su·∫•t bi·∫øn thi√™n t·∫°i ƒë·∫ßu",a:["C·ª±c ƒë·∫°i","B·∫±ng 0 (n√∫t √°p su·∫•t)","Ng·∫´u nhi√™n","Kh√¥ng ƒë·ªïi"],c:1},
      {q:"Trong s√≥ng d·ª´ng √¢m ·ªëng h·ªü-k√≠n, t·∫°i ƒë·∫ßu k√≠n √°p su·∫•t",a:["N√∫t √°p su·∫•t","B·ª•ng √°p su·∫•t","Kh√¥ng ƒë·ªïi","Ng·∫´u nhi√™n"],c:1},
      {q:"S√≥ng d·ª´ng y√™u c·∫ßu th·ªùi gian ƒëo",a:["R·∫•t ng·∫Øn","ƒê·ªß d√†i ƒë·ªÉ ·ªïn ƒë·ªãnh ch·∫ø ƒë·ªô","Kh√¥ng c·∫ßn","T√πy √Ω"],c:1},
      {q:"N·∫øu t·∫ßn s·ªë l·ªách kh·ªèi mode, m·∫´u h√¨nh n√∫t-b·ª•ng",a:["Bi·∫øn m·∫•t ho·∫∑c m·ªù","Kh√¥ng ƒë·ªïi","TƒÉng r√µ r·ªát","Th√™m n√∫t"],c:0},
      {q:"Khi ma s√°t/gi·∫£m ch·∫•n tƒÉng, bi√™n ƒë·ªô b·ª•ng",a:["Gi·∫£m","TƒÉng","Kh√¥ng ƒë·ªïi","TƒÉng r·ªìi gi·∫£m"],c:0},
      {q:"Trong d√¢y, h·ªá s·ªë ch·∫•t l∆∞·ª£ng Q cao d·∫´n ƒë·∫øn",a:["S√≥ng d·ª´ng s·∫Øc n√©t","S√≥ng d·ª´ng m·ªù","Kh√¥ng s√≥ng","Nhi·ªÅu nhi·ªÖu"],c:0},
      {q:"S√≥ng d·ª´ng l√† hi·ªán t∆∞·ª£ng c·ªßa",a:["Giao thoa s√≥ng c√πng t·∫ßn s·ªë ng∆∞·ª£c chi·ªÅu","Kh√∫c x·∫° m·∫°nh","Nhi·ªÖu x·∫° ·ªü khe","Ngu·ªìn ƒëa t·∫ßn"],c:0}
    ];

    // T·∫°o th·ª© t·ª± c√¢u theo c·∫£nh gi·ªõi
    const stageOrder = (() => {
      let idx = 0, order = [];
      for (const st of stages) {
        order.push({start: idx, count: st.count});
        idx += st.count;
      }
      return order;
    })();

    // L·∫•y ƒë·ªß 57 c√¢u t·ª´ ng√¢n h√†ng (shuffle r·ªìi c·∫Øt)
    const selected = (() => {
      const arr = [...bank];
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr.slice(0, stageOrder[stageOrder.length-1].start + stageOrder[stageOrder.length-1].count);
    })();

    // Tr·∫°ng th√°i game
    let stageIndex = 0;
    let questionIndexInStage = 0;
    let qi = 0;
    let timer = null;
    let t0 = 0;
    const duration = 10000; // 10 gi√¢y

    // DOM
    const startBtn = document.getElementById('startBtn');
    const quizBox = document.getElementById('quizBox');
    const questionText = document.getElementById('questionText');
    const answers = document.getElementById('answers');
    const statusText = document.getElementById('statusText');
    const timeBar = document.getElementById('timeBar');
    const realmPill = document.getElementById('realmPill');
    const qiPill = document.getElementById('qiPill');
    const toast = document.getElementById('toast');
    const rankBox = document.getElementById('rankBox');
    const rankList = document.getElementById('rankList');

    function showToast(msg, good=true) {
      toast.textContent = msg;
      toast.className = good ? 'toast' : 'toast fail';
      toast.style.display = 'block';
      setTimeout(() => { toast.style.display = 'none'; }, 1400);
    }

    function updateHUD() {
      realmPill.textContent = `C·∫£nh gi·ªõi: ${stages[stageIndex]?.name ?? '‚Äî'}`;
      qiPill.textContent = `Linh kh√≠: ${qi}`;
    }

    function startGame() {
      const name = document.getElementById('name').value.trim();
      if (!name) { showToast('H√£y nh·∫≠p ph√°p danh tu sƒ©!', false); return; }
      stageIndex = 0;
      questionIndexInStage = 0;
      qi = 0;
      quizBox.style.display = 'block';
      rankBox.style.display = 'none';
      updateHUD();
      nextQuestion();
      showToast(`Tu sƒ© ${name} ‚Äî kh·ªüi tu!`);
    }

    function getCurrentQuestion() {
      const base = stageOrder[stageIndex].start;
      const idx = base + questionIndexInStage;
      return selected[idx];
    }

    function nextQuestion() {
      clearInterval(timer);
      timeBar.style.width = '0%';

      const st = stages[stageIndex];
      if (!st) { // Ho√†n t·∫•t H√≥a Th·∫ßn
        endGame(true);
        return;
      }
      const q = getCurrentQuestion();
      questionText.innerHTML = `<span class="badge">${st.name}</span> ${q.q}`;
      answers.innerHTML = '';
      q.a.forEach((opt, i) => {
        const btn = document.createElement('button');
        btn.textContent = opt;
        btn.onclick = () => checkAnswer(i === q.c);
        answers.appendChild(btn);
      });
      statusText.textContent = `C√¢u ${questionIndexInStage+1}/${st.count} ‚Ä¢ Th·ªùi gian: 10 gi√¢y`;
      // Timer thanh ti·∫øn ƒë·ªô
      t0 = Date.now();
      timer = setInterval(() => {
        const elapsed = Date.now() - t0;
        const p = Math.min(100, (elapsed/duration)*100);
        timeBar.style.width = p + '%';
        if (elapsed >= duration) {
          clearInterval(timer);
          checkAnswer(false);
        }
      }, 60);
    }

    function checkAnswer(correct) {
      clearInterval(timer);
      if (correct) {
        qi += 100;
        questionIndexInStage++;
        showToast('+100 linh kh√≠', true);
        if (questionIndexInStage >= stages[stageIndex].count) {
          // Sang c·∫£nh gi·ªõi m·ªõi
          stageIndex++;
          questionIndexInStage = 0;
          updateHUD();
          if (stageIndex >= stages.length) {
            endGame(true);
            return;
          } else {
            showToast(`ƒê·ªôt ph√° ${stages[stageIndex].name}!`);
          }
        }
      } else {
        showToast('Ph√°p tr·∫≠n v·ª°! Tu l·∫°i c·∫£nh gi·ªõi n√†y...', false);
        questionIndexInStage = 0;
      }
      updateHUD();
      nextQuestion();
    }

    function endGame(victory) {
      quizBox.style.display = 'none';
      const name = document.getElementById('name').value.trim() || 'V√¥ Danh';
      if (victory) {
        showToast(`üéâ H√≥a Th·∫ßn! T·ªïng linh kh√≠: ${qi}`);
        // L∆∞u vinh danh c·ª•c b·ªô
        const record = { name, qi, time: new Date().toLocaleString() };
        const hall = JSON.parse(localStorage.getItem('hall') || '[]');
        hall.push(record);
        hall.sort((a,b) => b.qi - a.qi);
        localStorage.setItem('hall', JSON.stringify(hall.slice(0,10)));
        // Hi·ªán b·∫£ng
        const list = JSON.parse(localStorage.getItem('hall') || '[]');
        rankList.innerHTML = list.map((r,i)=>
          `<div class="item"><div>#${i+1} ‚Äî ${r.name}</div><div>${r.qi} linh kh√≠</div></div>`
        ).join('');
        rankBox.style.display = 'block';
      } else {
        showToast('K·∫øt th√∫c tu luy·ªán', false);
      }
    }

    document.getElementById('startBtn').addEventListener('click', startGame);
  </script>
</body>
</html>
